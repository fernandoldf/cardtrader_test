{% extends "base.html" %}

{% block title %}Card Recognition - Cardtrader Hub{% endblock %}

{% block content %}
<div class="container">
    <h2>Card Recognition</h2>
    <p class="text-secondary">Upload an image of a card (PNG, JPG, JPEG) up to 1MB.</p>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    
    <form class="form" action="{{ url_for('card_recognition') }}" method="post" enctype="multipart/form-data">
        <div class="file-input-wrapper">
            <input type="file" name="card_image" id="fileInput" accept="image/png,image/jpeg,image/jpg" required>
            <span class="file-input-label" id="fileLabel">Choose a file...</span>
        </div>
        <button type="submit" class="btn btn-full" id="submitBtn" disabled>Upload</button>
    </form>

    <a href="{{ url_for('home') }}" class="home-link">Back to Home</a>
</div>

<script>
    const fileInput = document.getElementById('fileInput');
    const fileLabel = document.getElementById('fileLabel');
    const submitBtn = document.getElementById('submitBtn');
    const MAX_FILE_SIZE = 1 * 1024 * 1024; // 1MB

    fileInput.addEventListener('change', () => {
        if (fileInput.files.length > 0) {
            const file = fileInput.files[0];
            fileLabel.textContent = file.name;

            if (file.size > MAX_FILE_SIZE) {
                alert('Error: File is larger than 1MB. Please choose a smaller file.');
                submitBtn.disabled = true;
            } else {
                submitBtn.disabled = false;
            }
        } else {
            fileLabel.textContent = 'Choose a file...';
            submitBtn.disabled = true;
        }
    });
</script>
{% endblock %}